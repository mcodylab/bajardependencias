trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

variables:
- group: varcody  # Grupo de variables con credenciales de JFrog

steps:


# ğŸ”¹ Descargar dependencias desde Artifactory asegurando versiÃ³n correcta
- script: |
    echo "ğŸ“Œ Instalando dependencias desde Artifactory con autenticaciÃ³n..."

    echo "ğŸ“Œ Configurando autenticaciÃ³n en JFrog Artifactory... EXPORT"

    pip install --no-cache-dir  --index-url=$(ARTIFACTORY_URL)  -r requirements.txt
  
    echo "ğŸ“Œ Verificando instalaciÃ³n de todas las dependencias..."
    while IFS= read -r package; do
        package_name=$(echo "$package" | cut -d'=' -f1)  # Extraer solo el nombre del paquete
        if pip list | grep -i "^$package_name "; then
            echo "âœ… $package_name estÃ¡ instalado"
        else
            echo "âŒ $package_name NO estÃ¡ instalado"
        fi
    done < <(grep -Eo '^[^#]+' requirements.txt | awk '{print $1}')
  displayName: 'Descargar e instalar dependencias desde Artifactory con autenticaciÃ³n'
